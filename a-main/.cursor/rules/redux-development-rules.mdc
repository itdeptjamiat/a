# EchoReads Redux Development Rules

## ğŸ—ƒï¸ Redux Toolkit Requirements

**ALL Redux code MUST use Redux Toolkit:**

```typescript
// âœ… CORRECT - Using Redux Toolkit
import { createSlice, createAsyncThunk, createSelector } from '@reduxjs/toolkit';

// âœ… CORRECT - Async thunk pattern
export const fetchData = createAsyncThunk(
  'module/fetchData',
  async (params: FetchParams, { rejectWithValue }) => {
    try {
      const response = await APIIns.get('/endpoint', { params });
      return response.data;
    } catch (error) {
      return rejectWithValue(error.response?.data?.message || 'Failed to fetch');
    }
  }
);

// âœ… CORRECT - Slice with extraReducers
const moduleSlice = createSlice({
  name: 'module',
  initialState,
  reducers: {},
  extraReducers: (builder) => {
    builder
      .addCase(fetchData.pending, (state) => {
        state.loading = true;
        state.error = null;
      })
      .addCase(fetchData.fulfilled, (state, action) => {
        state.loading = false;
        state.data = action.payload;
      })
      .addCase(fetchData.rejected, (state, action) => {
        state.loading = false;
        state.error = action.payload;
      });
  },
});

// âŒ INCORRECT - Plain Redux
import { createAction, createReducer } from 'redux';
```

## ğŸ“¡ API Integration Rules

- **ONLY use EchoInstance** from `/src/axios/EchoInstance.ts`
- **NEVER use axios directly** or create custom HTTP clients
- **Always use APIIns configured instance** for all API calls
- **Import APIIns from EchoInstance.ts** in all action files

## ğŸ”„ Async Actions Pattern

- **ONLY use createAsyncThunk** for all API calls
- **Always include try/catch blocks** with rejectWithValue
- **Handle all three states**: pending, fulfilled, rejected
- **Include loading and error states** in all slices

## ğŸ¯ Selector Requirements

- **Use createSelector for expensive selectors** - memoization required
- **Export all selectors** from `/src/redux/selectors/index.ts`
- **Use naming convention**: `select[ModuleName][Property]`
- **Import selectors in components** - never inline state access

## ğŸ“ File Structure Requirements

```
src/redux/
â”œâ”€â”€ slices/
â”‚   â””â”€â”€ [moduleName]Slice.ts      # State + reducers
â”œâ”€â”€ actions/
â”‚   â””â”€â”€ [moduleName]Actions.ts    # Async thunks
â”œâ”€â”€ selectors/
â”‚   â””â”€â”€ [moduleName]Selectors.ts  # Memoized selectors
â””â”€â”€ store.ts                      # Store configuration
```

## ğŸš« Prohibited Patterns

- âŒ No plain Redux - must use Redux Toolkit
- âŒ No API calls in slice files - only in actions
- âŒ No direct axios usage - must use EchoInstance
- âŒ No unmemoized expensive selectors
- âŒ No inline state access in components
- âŒ No missing error handling in async thunks

## âœ… Required Patterns

- âœ… Use createAsyncThunk for all API calls
- âœ… Use createSelector for expensive selectors
- âœ… Export selectors from index.ts
- âœ… Handle pending/fulfilled/rejected states
- âœ… Include loading and error states
- âœ… Use APIIns from EchoInstance
- âœ… Follow naming conventions

## ğŸ” Before Creating/Editing Redux Code

1. **Check existing Redux implementations** for patterns
2. **Use only Redux Toolkit functions**
3. **Follow the exact file structure**
4. **Export selectors from index.ts**
5. **Update store.ts with new reducers**
6. **Update README.md store shape section**

## ğŸ“š Redux Documentation

- **Update store shape** in README.md when adding new slices
- **Follow MODULE_CREATION_TEMPLATE.md** for new modules
- **Document all selectors** with clear naming
- **Include TypeScript interfaces** for all state types

Remember: All Redux code must use Redux Toolkit. Never use plain Redux or make API calls in slice files.
description:
globs:
alwaysApply: false
---
